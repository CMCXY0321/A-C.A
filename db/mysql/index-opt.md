#### 创建索引的优势
- 提高数据的检索速度，降低数据库IO成本：使用索引的意义就是通过缩小表中需要查询的记录的数目从而加快搜索的速度
- 降低数据排序的成本，降低CPU消耗：索引之所以查的快，是因为先将数据排好序，若该字段正好需要排序，则真好降低了排序的成本

#### 创建索引的劣势
- 占用存储空间：索引实际上也是一张表，记录了主键与索引字段，一般以索引文件的形式存储在磁盘上
- 降低更新表的速度：表的数据发生了变化，对应的索引也需要一起变更，从而减低的更新速度。否则索引指向的物理数据可能不对，这也是索引失效的原因之一
- 优质索引创建难：索引的创建并非一日之功，也并非一直不变。需要频繁根据用户的行为和具体的业务逻辑去创建最佳的索引

#### 索引分类
- BTree索引
- 聚合索引
- 次要索引
- 复合索引
- 前缀索引
- 唯一索引
- 统称索引
- B+树索引
- 哈希索引

- 单值索引：一个索引只包含单个列，一个表可以有多个单列索引
- 唯一索引：索引列的值必须唯一，但允许有空值
- 复合索引：一个索引包含多个列，实际开发中推荐使用

#### 需要建索引
- 主键，唯一索引
- 经常用作查询条件的字段需要创建索引
- 经常需要排序、分组和统计的字段需要建立索引
- 查询中与其他表关联的字段，外键关系建立索引

#### 不建索引
- 表的记录太少，百万级以下的数据不需要创建索引
- 经常增删改的表不需要创建索引
- 数据重复且分布平均的字段不需要创建索引，如 true,false 之类。
- 频发更新的字段不适合创建索引
- where条件里用不到的字段不需要创建索引

#### 性能分析（MySQL 自身瓶颈）
- CPU：CPU 在饱和的时候一般发生在数据装入内存或从磁盘上读取数据时候
- IO：磁盘I/O 瓶颈发生在装入数据远大于内存容量的时候
- 服务器硬件的性能瓶颈：top,free,iostat 和 vmstat来查看系统的性能状态

#### explain 分析sql语句
使用explain关键字可以模拟优化器执行sql查询语句，从而得知 MySQL 是如何处理 sql 语句

#### 性能下降的原因
- 查询语句写的不好
- 没建索引，索引建的不合理或索引失效
- 关联查询有太多的join

#### 从服务器的角度
- 服务器磁盘空间不足
- 服务器调优配置参数设置不合理

#### 总结
- 索引是排好序且快速查找的数据结构
- 其目的是为了提高查询的效率
- 创建索引后，查询数据变快，但更新数据变慢
- 性能下降的原因很可能是索引失效导致
- 索引创建的原则，经常查询的字段适合创建索引，频繁需要更新的数据不适合创建索引
- 索引字段频繁更新，或者表数据物理删除容易造成索引失效
- 擅用 explain 分析sql语句
- 除了优化sql语句外，还可以优化表的设计
- 如尽量做成单表查询，减少表之间的关联。设计归档表等
